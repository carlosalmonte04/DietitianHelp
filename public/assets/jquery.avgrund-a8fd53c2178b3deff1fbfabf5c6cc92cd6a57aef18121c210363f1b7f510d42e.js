!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){t.fn.avgrund=function(e){var i={width:640,height:300,showClose:!1,showCloseText:"",closeByEscape:!0,closeByDocument:!0,holderClass:"",overlayClass:"",enableStackAnimation:!1,onBlurContainer:"",openOnEvent:!0,setEvent:"click",onLoad:!1,onUnload:!1,onClosing:!1,template:"<p>This is test popin content!</p>"};return e=t.extend(i,e),this.each(function(){function i(t){e.closeByEscape&&27===t.keyCode&&r()}function n(i){e.closeByDocument?t(i.target).is(".avgrund-overlay, .avgrund-close")&&(i.preventDefault(),r()):t(i.target).is(".avgrund-close")&&(i.preventDefault(),r())}function s(){"function"==typeof e.onLoad&&e.onLoad(o),setTimeout(function(){a.addClass("avgrund-active")},100);var s=t('<div class="avgrund-popin '+e.holderClass+'"></div>');s.append(c),a.append(s),t(".avgrund-popin").css({width:l+"px",height:h+"px","margin-left":"-"+(l/2+10)+"px","margin-top":"-"+(h/2+10)+"px"}),e.showClose&&t(".avgrund-popin").append('<a href="#" class="avgrund-close">'+e.showCloseText+"</a>"),e.enableStackAnimation&&t(".avgrund-popin").addClass("stack"),a.bind("keyup",i).bind("click",n)}function r(){return!("function"==typeof e.onClosing&&!e.onClosing(o))&&(a.unbind("keyup",i).unbind("click",n).removeClass("avgrund-active"),setTimeout(function(){t(".avgrund-popin").remove()},500),void("function"==typeof e.onUnload&&e.onUnload(o)))}var o=t(this),a=t("body"),l=e.width>640?640:e.width,h=e.height>350?350:e.height,c="function"==typeof e.template?e.template(o):e.template;a.addClass("avgrund-ready"),0===t(".avgrund-overlay").length&&a.append('<div class="avgrund-overlay '+e.overlayClass+'"></div>'),""!==e.onBlurContainer&&t(e.onBlurContainer).addClass("avgrund-blur"),e.openOnEvent?o.bind(e.setEvent,function(e){e.stopPropagation(),t(e.target).is("a")&&e.preventDefault(),s()}):s()})}});