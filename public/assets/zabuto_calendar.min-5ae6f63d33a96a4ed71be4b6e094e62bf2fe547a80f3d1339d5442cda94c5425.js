if("undefined"==typeof jQuery)throw new Error("jQuery is not loaded");$.fn.zabuto_calendar=function(t){var e=$.extend({},$.fn.zabuto_calendar_defaults(),t),n=$.fn.zabuto_calendar_language(e.language);return e=$.extend({},e,n),this.each(function(){function t(){var t=parseInt(b.data("initYear")),e=parseInt(b.data("initMonth"))-1,r=new Date(t,e,1,0,0,0,0);b.data("initDate",r);var o=b.data("cellBorder")===!0?" table-bordered":"";$tableObj=$('<table class="table'+o+'"></table>'),$tableObj=n(b,$tableObj,r.getFullYear(),r.getMonth()),$legendObj=i(b);var s=$('<div class="zabuto_calendar" id="'+b.attr("id")+'"></div>');s.append($tableObj),s.append($legendObj),b.append(s)}function n(t,e,n,i){var a=new Date(n,i,1,0,0,0,0);return t.data("currDate",a),e.empty(),e=r(t,e,n,i),e=o(t,e),e=s(t,e,n,i),l(t,n,i),e}function i(t){var e=$('<div class="legend" id="'+t.attr("id")+'_legend"></div>'),n=t.data("legendList");return"object"==typeof n&&n.length>0&&$(n).each(function(t,n){if("object"==typeof n&&"type"in n){var i="";switch("label"in n&&(i=n.label),n.type){case"text":if(""!==i){var r="";if("badge"in n){if("undefined"==typeof n.classname)var o="badge-event";else var o=n.classname;r='<span class="badge '+o+'">'+n.badge+"</span> "}e.append('<span class="legend-'+n.type+'">'+r+i+"</span>")}break;case"block":if(""!==i&&(i="<span>"+i+"</span>"),"undefined"==typeof n.classname)var s="event";else var s="event-styled "+n.classname;e.append('<span class="legend-'+n.type+'"><ul class="legend"><li class="'+s+'"></li></u>'+i+"</span>");break;case"list":if("list"in n&&"object"==typeof n.list&&n.list.length>0){var a=$('<ul class="legend"></u>');$(n.list).each(function(t,e){a.append('<li class="'+e+'"></li>')}),e.append(a)}break;case"spacer":e.append('<span class="legend-'+n.type+'"> </span>')}}}),e}function r(t,e,i,r){var o=t.data("navIcons"),s=$('<span><span class="glyphicon glyphicon-chevron-left"></span></span>'),a=$('<span><span class="glyphicon glyphicon-chevron-right"></span></span>');"object"==typeof o&&("prev"in o&&s.html(o.prev),"next"in o&&a.html(o.next));var l=t.data("showPrevious");"number"!=typeof l&&l!==!1||(l=y(t.data("showPrevious"),!0));var c=$('<div class="calendar-month-navigation"></div>');c.attr("id",t.attr("id")+"_nav-prev"),c.data("navigation","prev"),l!==!1&&(prevMonth=r-1,prevYear=i,prevMonth==-1&&(prevYear-=1,prevMonth=11),c.data("to",{year:prevYear,month:prevMonth+1}),c.append(s),"function"==typeof t.data("actionNavFunction")&&c.click(t.data("actionNavFunction")),c.click(function(){n(t,e,prevYear,prevMonth)}));var u=t.data("showNext");"number"!=typeof u&&u!==!1||(u=y(t.data("showNext"),!1));var h=$('<div class="calendar-month-navigation"></div>');h.attr("id",t.attr("id")+"_nav-next"),h.data("navigation","next"),u!==!1&&(nextMonth=r+1,nextYear=i,12==nextMonth&&(nextYear+=1,nextMonth=0),h.data("to",{year:nextYear,month:nextMonth+1}),h.append(a),"function"==typeof t.data("actionNavFunction")&&h.click(t.data("actionNavFunction")),h.click(function(){n(t,e,nextYear,nextMonth)}));var d=t.data("monthLabels"),p=$("<th></th>").append(c),f=$("<th></th>").append(h),g=$("<span>"+d[r]+" "+i+"</span>");g.dblclick(function(){var i=t.data("initDate");n(t,e,i.getFullYear(),i.getMonth())});var m=$('<th colspan="5"></th>');m.append(g);var v=$('<tr class="calendar-month-header"></tr>');return v.append(p,m,f),e.append(v),e}function o(t,e){if(t.data("showDays")===!0){var n=t.data("weekStartsOn"),i=t.data("dowLabels");if(0===n){var r=$.extend([],i),o=new Array(r.pop());i=o.concat(r)}var s=$('<tr class="calendar-dow-header"></tr>');$(i).each(function(t,e){s.append("<th>"+e+"</th>")}),e.append(s)}return e}function s(t,e,n,i){var r=(t.data("ajaxSettings"),g(n,i)),o=f(n,i),s=p(n,i,1),a=p(n,i,o),l=1,c=t.data("weekStartsOn");0===c&&(6==a&&r++,6!=s||0!=a&&1!=a&&5!=a||r--,s++,7==s&&(s=0));for(var d=0;d<r;d++){for(var m=$('<tr class="calendar-dow"></tr>'),v=0;v<7;v++){if(v<s||l>o)m.append("<td></td>");else{var y=t.attr("id")+"_"+h(n,i,l),b=y+"_day",x=$('<div id="'+b+'" class="day" >'+l+"</div>");x.data("day",l),t.data("showToday")===!0&&u(n,i,l)&&x.html('<span class="badge badge-today">'+l+"</span>");var w=$('<td id="'+y+'"></td>');w.append(x),w.data("date",h(n,i,l)),w.data("hasEvent",!1),"function"==typeof t.data("actionFunction")&&(w.addClass("dow-clickable"),w.click(function(){t.data("selectedDate",$(this).data("date"))}),w.click(t.data("actionFunction"))),m.append(w),l++}6==v&&(s=0)}e.append(m)}return e}function a(t,e,n,i){var r=$('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'),o=$('<h4 class="modal-title" id="'+t+'_modal_title">'+e+"</h4>"),s=$('<div class="modal-header"></div>');s.append(r),s.append(o);var a=$('<div class="modal-body" id="'+t+'_modal_body">'+n+"</div>"),l=$('<div class="modal-footer" id="'+t+'_modal_footer"></div>');if("undefined"!=typeof i){var c=$("<div>"+i+"</div>");l.append(c)}var u=$('<div class="modal-content"></div>');u.append(s),u.append(a),u.append(l);var h=$('<div class="modal-dialog"></div>');h.append(u);var d=$('<div class="modal fade" id="'+t+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+t+'_modal_title" aria-hidden="true"></div>');return d.append(h),d.data("dateId",t),d.attr("dateId",t),d}function l(t,e,n){var i=t.data("ajaxSettings");if(t.data("events",!1),i===!1)return!0;if("object"!=typeof i||"undefined"==typeof i.url)return alert("Invalid calendar event settings"),!1;var r={year:e,month:n+1};$.ajax({type:"GET",url:i.url,data:r,dataType:"json"}).done(function(e){var n=[];$.each(e,function(t){n.push(e[t])}),t.data("events",n),c(t)})}function c(t){var e=t.data("ajaxSettings"),n=t.data("events");n!==!1&&$(n).each(function(n,i){var r=t.attr("id")+"_"+i.date,o=$("#"+r),s=$("#"+r+"_day");if(o.data("hasEvent",!0),"undefined"!=typeof i.title&&o.attr("title",i.title),"undefined"==typeof i.classname?o.addClass("event"):(o.addClass("event-styled"),s.addClass(i.classname)),"undefined"!=typeof i.badge&&i.badge!==!1){var l=i.badge===!0?"":" badge-"+i.badge,c=s.data("day");s.html('<span class="badge badge-event'+l+'">'+c+"</span>")}if("undefined"!=typeof i.body&&"modal"in e&&e.modal===!0){o.addClass("event-clickable");var u=a(r,i.title,i.body,i.footer);$("body").append(u),$("#"+r).click(function(){$("#"+r+"_modal").modal()})}})}function u(t,e,n){var i=new Date,r=new Date(t,e,n);return r.toDateString()==i.toDateString()}function h(t,e,n){return d=n<10?"0"+n:n,m=e+1,m=m<10?"0"+m:m,t+"-"+m+"-"+d}function p(t,e,n){var i=new Date(t,e,n,0,0,0,0),r=i.getDay();return 0==r?r=6:r--,r}function f(t,e){for(var n=28;v(t,e+1,n+1);)n++;return n}function g(t,e){var n=f(t,e),i=p(t,e,1),r=p(t,e,n),o=n,s=i-r;return s>0&&(o+=s),Math.ceil(o/7)}function v(t,e,n){return e>0&&e<13&&t>0&&t<32768&&n>0&&n<=new Date(t,e,0).getDate()}function y(t,e){t===!1&&(t=0);var n,i=b.data("currDate"),r=b.data("initDate");if(n=12*(r.getFullYear()-i.getFullYear()),n-=i.getMonth()+1,n+=r.getMonth(),e===!0){if(n<parseInt(t)-1)return!0}else if(n>=0-parseInt(t))return!0;return!1}var b=$(this);b.attr("id","zabuto_calendar_"+Math.floor(99999*Math.random()).toString(36)),b.data("initYear",e.year),b.data("initMonth",e.month),b.data("monthLabels",e.month_labels),b.data("weekStartsOn",e.weekstartson),b.data("navIcons",e.nav_icon),b.data("dowLabels",e.dow_labels),b.data("showToday",e.today),b.data("showDays",e.show_days),b.data("showPrevious",e.show_previous),b.data("showNext",e.show_next),b.data("cellBorder",e.cell_border),b.data("ajaxSettings",e.ajax),b.data("legendList",e.legend),b.data("actionFunction",e.action),b.data("actionNavFunction",e.action_nav),t()}),this},$.fn.zabuto_calendar_defaults=function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i={language:!1,year:e,month:n,show_previous:!0,show_next:!0,cell_border:!1,today:!1,show_days:!0,weekstartson:1,nav_icon:!1,ajax:!1,legend:!1,action:!1,action_nav:!1};return i},$.fn.zabuto_calendar_language=function(t){switch("undefined"!=typeof t&&t!==!1||(t="en"),t.toLowerCase()){case"de":return{month_labels:["Januar","Februar","M\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dow_labels:["Mo","Di","Mi","Do","Fr","Sa","So"]};case"en":return{month_labels:["January","February","March","April","May","June","July","August","September","October","November","December"],dow_labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]};case"es":return{month_labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dow_labels:["Lu","Ma","Mi","Ju","Vi","S\xe1","Do"]};case"fr":return{month_labels:["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],dow_labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]};case"it":return{month_labels:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dow_labels:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"]};case"nl":return{month_labels:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],dow_labels:["Ma","Di","Wo","Do","Vr","Za","Zo"]};case"pt":return{month_labels:["Janeiro","Fevereiro","Marco","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dow_labels:["S","T","Q","Q","S","S","D"]}}};